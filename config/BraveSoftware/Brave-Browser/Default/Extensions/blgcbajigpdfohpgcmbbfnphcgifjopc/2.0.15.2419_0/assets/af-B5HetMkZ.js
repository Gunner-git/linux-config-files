import"./modulepreload-polyfill-xVUEmHkd.js";import{_ as B,d as ne}from"./_plugin-vue_export-helper-BZooHx69.js";import{u as K,c as q,a as oe,f as le}from"./unhandledErrorHandler-C98_RUwm.js";import{i as ie}from"./i18n-BpGmPe0p.js";import{U as P,V as G,a0 as p,W as a,X as u,Y as c,_ as L,Z as e,a2 as w,a9 as F,ao as ue,$ as M,a3 as z,aC as X,a8 as N,a6 as H,ai as V,O as re,aL as de,a4 as S,ae as ce,e as me,b as J,aM as pe,aN as ee,aO as ge,aP as ve,a1 as ye,aQ as fe,aR as we,aS as he,aG as _e,aT as ke,aU as Ie,aV as Y,aW as Ce}from"./Settings-xuVU-BgW.js";import{a as be,c as Se,b as Le}from"./autofillFunctions-DCONxKp6.js";import{k as Z,a as Te,L as $,c as Ae}from"./CardListItem-Sb3vbqdK.js";import{W as Ee}from"./WebsiteIcon-BwbmP-bA.js";import{i as Oe}from"./isVisible-D3ksDT_w.js";import{S as ae,P as Ue,_ as We}from"./PasswordStrengthFeedback.vue_vue_type_script_setup_true_lang-CHv-WMdZ.js";import{u as Ne,S as He,P as Me}from"./Slider-Zv54kL_P.js";import{A as D}from"./types-DUgExzQo.js";const Pe={class:"locked-vault"},Ge={class:"header"},Re={class:"message"},De=B(P({__name:"LockedVault",setup(T){const{t:g}=G(),d=K(),l=p(()=>g("pwm_locked_vault_unlock.message",{COMMAND:d.openCommand}));return(r,i)=>(a(),u("div",Pe,[c("div",Ge,[c("h6",null,L(e(g)("pwm_locked_vault_password_manager.message")),1)]),c("div",Re,[c("p",null,L(e(l)),1)])]))}}),[["__scopeId","data-v-7d86c69a"]]),Ve={class:"info"},Fe={class:"title"},ze={class:"subtitle"},Be=P({__name:"TotpListItem",props:{document:{}},setup(T){const{t:g}=G(),d=w(),l=T,r=w(null),i=w(),m=async()=>{var t;i.value=r.value!==null&&Oe(r.value),((t=d.value)==null?void 0:t.timerId)===void 0&&await Te({type:"gettotp",uuid:l.document.uuid},d,r.value),i.value||Z(d)};return document.addEventListener("scroll",t=>{m()},{capture:!0}),F(async()=>{m()}),ue(()=>{Z(d)}),(t,_)=>{var v;return a(),u("div",{class:"item-wrapper",ref_key:"loginItemEl",ref:r},[M(Ee,{title:t.document.title,domain:t.document.domain},null,8,["title","domain"]),c("div",Ve,[c("div",Fe,L(t.document.title),1),c("div",ze,L(e(g)("pwm_2fa_popup_subtitle.message",{CODE:((v=e(d))==null?void 0:v.code)??""})),1)])],512)}}}),qe={class:"autofill-suggestions"},xe={key:0},Qe=c("button",{class:"add"},null,-1),Ye=["innerHTML"],Ze={key:1,id:"domainEntries"},$e=["innerHTML"],j=P({__name:"AutofillLoginSuggestions",props:{url:{},frameId:{},itemType:{}},emits:["fillInputs","showAutofillWarning"],setup(T,{emit:g}){const{t:d}=G(),l=q(),r=w(),i=w({}),m=w(!1),t=T,_=g,v=p(()=>l.documents!==void 0),y=p(()=>{var s;return((s=l.documents)==null?void 0:s.filter(U=>U.type==="login"))??[]}),k=p(()=>[...y.value].sort((s,U)=>s.title.localeCompare(U.title,[],{sensitivity:"base"}))),b=p(()=>ce(k.value,t.url.href,i.value)),C=p(()=>b.value.matchingHostname.map(s=>({...s,matching:"hostname"}))),A=p(()=>b.value.matchingDomain.map(s=>({...s,matching:"domain"}))),W=p(()=>C.value.concat(A.value)),E=w(),n=p(()=>C.value.length>0),o=p(()=>A.value.length>0),h=p(()=>{var s;return t.itemType==="totp"&&(((s=E.value)==null?void 0:s.length)??0)>0}),I=p(()=>d("no_logins_saved_for_website.message",{HOST:me(t.url.host)})),O=async s=>{const U=await l.getEntryPassword(s.uuid),f=await J([s.uuid]),R={...s,password:U,totp:f.code};pe(t.url,s,i.value)?(Q=>{const se=ve(Q.domain,t.url);_("showAutofillWarning",{document:Q,isInsecureWarning:se})})(R):_("fillInputs",s,t.itemType)};F(()=>{chrome.tabs.query({active:!0,currentWindow:!0},s=>{r.value=s[0].id}),x(),chrome.runtime.onMessage.addListener(s=>{s.action==="checkIfFormDirty"&&x()}),be().then(s=>{i.value=s})});const x=()=>{Se().then(s=>{m.value=s})},te=()=>{re(r.value,t.frameId),de(r.value,t.frameId)};return t.itemType==="totp"&&z(W,async s=>{const U=await new ee().readAny("selectedLoginUuid"),f=await ge(s,U);E.value=f},{immediate:!0}),(s,U)=>(a(),u("div",qe,[e(v)?(a(),u(N,{key:1},[e(m)&&t.itemType!=="totp"?(a(),u("div",{key:0,id:"addNewEntry",onClick:te},[Qe,c("span",null,L(e(d)("autofill_add_new_entry.message")),1)])):H("",!0),t.itemType==="totp"?(a(),u(N,{key:1},[e(h)?(a(!0),u(N,{key:0},V(e(E),f=>(a(),S(Be,{class:"documents-list-item","data-test":"totp-item",key:f.uuid,document:f,onClick:R=>O(f)},null,8,["document","onClick"]))),128)):(a(),u("p",{key:1,innerHTML:e(I)},null,8,Ye))],64)):t.itemType==="login"?(a(),u(N,{key:2},[e(n)?(a(!0),u(N,{key:0},V(e(C),f=>(a(),S($,{class:"documents-list-item",key:f.uuid,document:f,onClick:R=>O(f)},null,8,["document","onClick"]))),128)):H("",!0),e(o)?(a(),u("div",Ze)):H("",!0),(a(!0),u(N,null,V(e(A),f=>(a(),S($,{class:"documents-list-item",key:f.uuid,document:f,onClick:R=>O(f)},null,8,["document","onClick"]))),128)),e(n)||e(o)||e(m)?H("",!0):(a(),u("p",{key:2,innerHTML:e(I)},null,8,$e))],64)):H("",!0)],64)):(a(),u("p",xe,[X(L(e(d)("autofill_loading_login_documents.message"))+" ",1),M(ae)]))]))}}),je={class:"autofill-suggestions"},Ke={key:0},Xe=B(P({__name:"AutofillCardSuggestions",emits:["fillInputs"],setup(T,{emit:g}){const{t:d}=G(),l=q(),r=g,i=p(()=>l.documents!==void 0),m=p(()=>(l.documents??[]).filter(t=>t.type==="card"));return(t,_)=>(a(),u("div",je,[e(i)?(a(!0),u(N,{key:1},V(e(m),v=>(a(),S(Ae,{class:"documents-list-item",key:v.uuid,document:v,"icon-size":"sm","is-parent-popup":!1,onClick:y=>(k=>{r("fillInputs",k)})(v)},null,8,["document","onClick"]))),128)):(a(),u("p",Ke,[X(L(e(d)("autofill_loading_card_documents.message")),1),M(ae)]))]))}}),[["__scopeId","data-v-9c63250f"]]),Je={class:"password-wrapper"},ea={class:"password-label"},aa={class:"label"},ta=["innerHTML"],sa={class:"buttons"},na={key:0,class:"advanced-generator","data-test":"advanced-generator"},oa={class:"mb-20 mt-10",id:"passwordLength"},la=B(P({__name:"PasswordGeneratorAutofill",props:{category:{},frameId:{}},setup(T){const{t:g}=G(),{passwordStrength:d,generatePassword:l,recipe:r,generatedPassword:i,handleLengthChange:m,handleCriteriaChange:t}=Ne(),_=T,v=w(null),y=w(null),k=w(),b=w(!1),C=w(),A=p(()=>{var o;return(o=d.value)==null?void 0:o.score}),W=p(()=>we(i.value));F(()=>{chrome.tabs.getCurrent(o=>{k.value=o})}),z(v,o=>{const h=new ResizeObserver(I=>{var O;C.value=(O=v.value)==null?void 0:O.clientHeight});o&&(C.value=o.clientHeight,h.observe(o))}),z(C,(o,h)=>{var I;if((I=k.value)!=null&&I.id&&o&&h){const O=o-h;he(k.value.id,_.frameId,{heightIncrease:O})}});const E=()=>{var o;((o=k.value)==null?void 0:o.id)!==void 0&&_.category!==void 0&&fe(k.value.id,_.frameId,{category:_.category,password:i.value})},n=()=>{b.value=!b.value};return(o,h)=>(a(),u("div",{class:"autofill-password-generator",ref_key:"autofillEl",ref:y},[M(Ue,{score:e(A),type:"entry"},null,8,["score"]),c("div",Je,[c("div",ea,[c("div",aa,L(e(g)("password_generator_password_label.message")),1),c("div",{class:"password",innerHTML:e(W),onClick:E,"data-test":"generated-password",ref_key:"passwordEl",ref:v},null,8,ta)]),c("div",sa,[c("div",{class:"icon refresh",onClick:h[0]||(h[0]=(...I)=>e(l)&&e(l)(...I)),"data-test":"generate-password"}),c("div",{class:ye(["icon open-advanced-generator",{open:e(b)}]),onClick:n,"data-test":"toggle-advanced"},null,2)])]),e(b)?(a(),u("div",na,[M(We,{class:"mt-5",passwordStrength:e(d),keypathEmptyLabel:"primary_password_strength_empty"},null,8,["passwordStrength"]),c("div",oa,[M(He,{value:e(r).length,min:8,max:55,onInput:e(m)},null,8,["value","onInput"]),c("span",null,L(e(r).length),1)]),M(Me,{mustContainUppercase:e(r).mustContainUppercase,mustContainNumber:e(r).mustContainNumber,mustContainSymbol:e(r).mustContainSymbol,onChange:e(t)},null,8,["mustContainUppercase","mustContainNumber","mustContainSymbol","onChange"])])):H("",!0)],512))}}),[["__scopeId","data-v-62a92704"]]),ia=["login","card"],ua={class:"autofill-wrapper"},ra=P({__name:"AutofillWrapper",setup(T){const g=w(void 0),d=K(),l=q(),r=p(()=>l.isVaultUnlocked),i=w(),m=new URLSearchParams(window.location.search),t=m.get("category"),_=(v=t,ia.includes(v)?t:void 0);var v;const y=parseInt(m.get("frameId"),10),k=m.get("type")===D.PASSWORD_GENERATOR,b=m.get("type")===D.CARD_SUGGESTIONS,C=m.get("type")===D.LOGIN_SUGGESTIONS,A=m.get("type")===D.TOTP_SUGGESTIONS;async function W(n){switch(n.type){case"login":{const o=await l.getEntryPassword(n.uuid),h=await J([n.uuid]);Y(i.value,y,{document:{...n,password:o,totp:h.code}});const I=new ee;C&&I.writeAny("selectedLoginUuid",n.uuid),A&&I.removeItem("selectedLoginUuid");break}case"card":{const{cardNumber:o,securityCode:h}=await l.getCardBody(n.uuid);await Y(i.value,y,{document:{...n,cardNumber:o,securityCode:h}});break}}}async function E({document:n,isInsecureWarning:o}){n.type==="login"&&await Ce(i.value,y,{document:n,isInsecureWarning:o})}return _e(()=>{l.getDocuments(),l.checkAccountStatus(),l.checkVaultLockStatus(),d.setBrowserInfo()}),F(async()=>{if(chrome.tabs.query({active:!0,currentWindow:!0},n=>{i.value=n[0].id}),y>=0){const n=await Le([y]);n&&(g.value=new URL(n))}i.value&&g.value&&(ke(i.value,y,{height:document.body.scrollHeight}),new ResizeObserver(n=>{Ie(i.value,y,{height:n[0].target.clientHeight})}).observe(document.body))}),chrome.runtime.onMessage.addListener(async n=>{n.action==="checkVaultLockStatus"&&l.checkVaultLockStatus()}),(n,o)=>(a(),u("div",ua,[e(r)&&e(g)?k?(a(),S(la,{key:1,category:e(_),frameId:e(y)},null,8,["category","frameId"])):b?(a(),S(Xe,{key:2,onFillInputs:W})):C?(a(),S(j,{key:3,url:e(g),frameId:e(y),"item-type":"login",onFillInputs:W,onShowAutofillWarning:E},null,8,["url","frameId"])):A?(a(),S(j,{key:4,url:e(g),frameId:e(y),"item-type":"totp",onFillInputs:W,onShowAutofillWarning:E},null,8,["url","frameId"])):H("",!0):(a(),S(De,{key:0}))]))}});oe("autofill"),ne(ra).use(ie).use(le()).mount("#app");
